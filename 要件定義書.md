# トーラムオンライン ダメージ計算ツール 要件定義書

## 1. プロジェクト概要
MMORPGトーラムオンラインのダメージ計算を行うWebアプリケーション

## 2. 機能要件

### 2.1 対象となるダメージ計算
- 通常攻撃のダメージ計算
- スキル攻撃のダメージ計算

### 2.2 入力項目

#### 2.2.1 キャラクターステータス
- STR（力）: 1-510
- INT（知力）: 1-510
- VIT（体力）: 1-510
- AGI（俊敏性）: 1-510
- DEX（器用さ）: 1-510
- CRT（クリティカル）: 1-255
- MEN（精神力）: 1-255
- TEC（技術力）: 1-255
- LUK（運）: 1-255
- レベル: 1-300

#### 2.2.2 武器関連
**メイン武器**
- 武器種（片手剣、両手剣、杖など）
- 武器ATK
- 安定率
- 精錬値

**サブ武器**
- 武器種（ナイフ、矢など）
- 精錬値

**クリスタ（プリセット選択式）**
- 武器クリスタ（2枠）
  - ドン・プロフンド（ATK10%, STR7%, クリティカル率8%, DEF -27%）
  - 黒衣の聖誕姫（例プロパティ）
- 防具クリスタ（2枠）
  - ccc（例プロパティ）
  - ddd（例プロパティ）
- 追加クリスタ（2枠）
  - aaa（例プロパティ）
  - bbb（例プロパティ）
- 特殊クリスタ（2枠）
  - eee（例プロパティ）
  - fff（例プロパティ）
- ノーマルクリスタ
  - 全てのスロット（武器、防具、追加、特殊）に装着可能
  - 汎用的なプロパティを持つクリスタ

**クリスタデータ管理方式**
- プリセットクリスタ: JSONファイルで管理（`src/data/crystals.json`）
- ユーザーカスタムクリスタ: LocalStorageで管理
- データ統合: プリセット + ユーザーカスタムを統合してリスト表示

**クリスタ選択UI**
- オーバーレイモーダル方式での選択画面
- グリッドレイアウトでのクリスタ一覧表示
- クリスタカード形式（名前、効果、説明表示）
- タイプ別フィルタリング（専用/ノーマル）
- 背景クリック・ESCキーでモーダル閉じる
- 検索・絞り込み機能（将来実装予定）

#### 2.2.3 装備システム

**装備カテゴリ**
- メイン装備
- 体装備
- 追加装備
- 特殊装備
- サブ武器
- オシャレ装備1
- オシャレ装備2
- オシャレ装備3
- 武器クリスタ
- 防具クリスタ
- 追加クリスタ
- 特殊クリスタ

**装備プリセット選択機能**
- プリセット装備: JSONファイルで管理（`src/data/equipments.json`）
- ユーザーカスタム装備: LocalStorageで管理
- データ統合: プリセット + ユーザーカスタムを統合してリスト表示

**装備選択UI**
- タブ切り替え式装備管理画面（8つの装備スロット対応）
- 各装備スロットでプリセット選択機能
- オーバーレイモーダル方式での装備選択画面（クリスタ選択と同一UI）
- グリッドレイアウトでの装備一覧表示
- 装備カード形式（名前、基本性能、プロパティ表示）
- 装備タイプ別フィルタリング（武器/防具/アクセサリ/オシャレ等）
- 手動プロパティ入力機能との併用（プリセット選択後に微調整可能）
- 背景クリック・ESCキーでモーダル閉じる
- 検索・絞り込み機能（将来実装予定）

**装備データ構造**
- 装備ID、装備名、装備タイプ
- 基本性能（ATK、DEF、安定率等）
- 付与プロパティ（各種%効果、固定値効果）
- 説明文、入手方法等のメタ情報

#### 2.2.4 各装備のプロパティ
- ATK%
- ATK
- MATK%
- MATK
- 武器ATK%
- 武器ATK
- 物理貫通%
- 魔法貫通%
- 属性有利%
- 抜刀威力%
- 抜刀威力
- 近距離威力%
- 遠距離威力%
- クリティカルダメージ%
- クリティカルダメージ
- クリティカル率%
- クリティカル率
- 安定率%
- HP%
- HP
- MP
- STR%
- STR
- INT%
- INT
- VIT%
- AGI%
- AGI
- DEX%
- DEX
- 命中%
- 命中
- 回避%
- 回避
- 攻撃速度%
- 攻撃速度
- 詠唱速度%
- 詠唱速度

#### 2.2.5 敵（防御側）の情報
- 敵のDEF（物理防御力）
- 敵のMDEF（魔法防御力）
- 敵のレベル
- 確定クリティカル（数値、例：100）
- free値

### 2.3 出力項目
- ダメージ計算結果
- 合計ステータス表示

## 3. 非機能要件

### 3.1 UI/UX要件
- 日本語インターフェース
- リアルタイム計算（入力と同時に結果表示）
- レスポンシブデザイン
- モダンなクリスタ選択UI（オーバーレイ + グリッド表示）

### 3.2 技術要件
- Next.js 15 + React 19
- TypeScript
- Tailwind CSS
- リアルタイム状態管理

### 3.3 データ管理要件
- プリセットクリスタ: JSONファイル管理（`src/data/crystals.json`）
- プリセット装備: JSONファイル管理（`src/data/equipments.json`）
- ユーザーカスタムデータ: LocalStorage管理
  - カスタムクリスタ
  - カスタム装備
- データの永続化とインポート/エクスポート対応

## 4. 開発フェーズ

### フェーズ1（現在）
- 入力フォームの実装
- 基本的なステータス合計表示
- リアルタイム入力対応
- プリセットクリスタ選択システム（JSONベース）
- タブ切り替え式装備管理画面
- プリセット装備選択システム（JSONベース）

### フェーズ2（今後）
- ダメージ計算ロジックの実装
- 計算結果の詳細表示
- データの保存・読み込み機能
- ユーザーによるクリスタ編集・保存機能（LocalStorageベース）
- ユーザーによる装備編集・保存機能（LocalStorageベース）
- 装備・クリスタの組み合わせ最適化機能

### フェーズ3（将来）
- 装備セット保存・読み込み機能
- 複数キャラクター管理機能
- 装備・クリスタデータのインポート/エクスポート機能
- 検索・絞り込み機能の強化

## 5. 制約事項
- 計算ロジックは複雑なため、フェーズ1では実装せず、入力フォームに集中
- 表示形式の詳細は後の設計で決定