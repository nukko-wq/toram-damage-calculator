# 術式/ストーム(1/6hit) - 攻撃スキル仕様書

## 基本情報

| 項目 | 値 |
|------|-----|
| スキル名 | 術式/ストーム(1/6hit) |
| 英語名 | Formula/Storm (1/6hit) |
| スキルID | storm-1-6hit |
| 分類 | 魔法スキル |
| 系統 | 術式系 |
| 対象 | 複数敵 |
| 射程 | 遠距離 |
| 消費MP | - |
| 詠唱時間 | - |

## スキル効果

### 基本効果
- 指定範囲に風属性の魔法攻撃を行う
- 複数の敵にダメージを与える範囲攻撃
- 全6hitのうち1hitのダメージを計算

### ダメージ計算

#### 威力参照
- **威力参照**: MATK
- **基本倍率**: 200%（杖装備時300%）
- **固定ダメージ**: 400
- **属性**: 風属性

#### 計算式
```
ダメージ = MATK × スキル倍率 × 各種補正 + 固定ダメージ
```

#### 武器種別補正
- **基本**: 200%
- **杖装備時**: 300%（+100%）
- **魔導具装備時**: 200%

#### 適用される補正
- MATK補正
- 魔法攻撃力補正
- 風属性補正（属性有利など）
- 魔法貫通補正
- 遠距離威力補正
- その他魔法系補正

## スキル仕様

### 発動条件
- 術式系スキルツリーで習得
- 魔法武器（杖・魔導具）装備時に使用可能

### 特殊効果
- 複数hitするスキルの1hit分のダメージ
- 範囲攻撃のため複数の敵に同時ダメージ
- 風属性攻撃

### 制限事項
- 魔法武器装備時のみ使用可能
- 詠唱時間あり
- MP消費あり

## 実装仕様

### AttackSkill オブジェクト

```typescript
{
  // 基本情報
  id: 'storm_1_6hit',
  name: '術式/ストーム(1/6hit)',
  order: 602,                    // 魔法系統600番台（術式/アローの後）
  systemGroup: 'magic',          // 魔法系統
  category: 'staff',             // 杖カテゴリ（術式/アローと同じ）
  weaponTypeRequirements: ['杖', '魔導具'],
  
  // 消費・条件
  mpCost: 400,                   // MP消費400
  
  // 表示用計算式説明
  multiplierFormula: '200% (杖装備時300%)',
  fixedDamageFormula: '400',
  
  // 攻撃情報（1hit攻撃：6hitのうち1hit）
  hits: [
    {
      hitNumber: 1,
      attackType: 'magical',
      referenceDefense: 'MDEF',
      referenceResistance: 'magical',
      powerReference: 'MATK',
      
      // 表示用倍率・固定値
      multiplier: 200,           // 表示用（実際の計算は外部）
      fixedDamage: 400,          // 固定ダメージ400
      
      // 計算式説明
      multiplierFormula: '杖装備時：威力+100%',
      fixedDamageFormula: '400',
      
      // 慣れ設定
      familiarity: 'magical',    // 魔法慣れ参照
      familiarityGrant: 'magical', // 魔法慣れ付与
      
      // 補正適用設定
      canUseUnsheathePower: false,   // 抜刀威力適用不可
      canUseLongRange: true,         // ロングレンジ適用可能
      canUseShortRangePower: true,   // 近距離威力適用可能
      canUseLongRangePower: true     // 遠距離威力適用可能
    }
  ],
  
  // 特殊効果
  specialEffects: [
    '魔法攻撃',
    '範囲攻撃',
    '6hitのうち1hit'
  ]
}
```

### 計算処理での考慮事項
1. **威力参照**: MATKを基準とした魔法攻撃
2. **属性補正**: 風属性として計算
3. **射程補正**: 遠距離威力補正を適用
4. **武器制限**: 杖・魔導具装備時のみ有効
5. **hit数**: 全6hitのうち1hitとして計算

## 関連スキル

### 同系統スキル
- 術式/ストーム（全6hit）
- 術式/インパクト
- 術式/フィニッシャー
- 術式/バースト

### 連携スキル
- 魔法系バフスキル
- 風属性強化スキル
- 詠唱短縮スキル

## バランス調整履歴

| 日付 | 変更内容 | 備考 |
|------|----------|------|
| - | - | - |

## 検証データ

### テスト条件
- レベル: 200
- MATK: 5000
- 風属性有利: 23%
- 魔法貫通: 0%
- 遠距離威力: 0%

### 期待ダメージ
| 条件 | 期待値 | 実測値 | 状態 |
|------|--------|--------|------|
| 基本（魔導具） | 10400 | - | 🔄 |
| 杖装備時 | 15400 | - | 🔄 |

**計算例（基本）:**
- ダメージ = 5000 × 200% + 400 = 10000 + 400 = 10400

**計算例（杖装備時）:**
- ダメージ = 5000 × 300% + 400 = 15000 + 400 = 15400

**凡例:**
- ✅: 検証済み（正確）
- 🔄: 検証待ち
- ❌: 要修正

## 実装状況

- [ ] 基本データ登録
- [ ] ダメージ計算実装
- [ ] 武器制限チェック
- [ ] 属性補正適用
- [ ] 射程補正適用
- [ ] テストケース作成

## 注意事項

1. **hit数の扱い**: 全6hitのうち1hitとして計算するため、実際の全hitダメージは6倍
2. **属性補正**: 風属性として適切に補正を適用
3. **武器制限**: 魔法武器以外では使用不可
4. **射程**: 遠距離攻撃として遠距離威力補正を適用

## 関連ドキュメント

- [攻撃スキル一覧](../attack-skills.md)
- [魔法攻撃力計算](../../calculations/matk-calculation.md)
- [属性システム](../../technical/element-system.md)
- [スキル系統](../skill-trees.md)

## 更新履歴

| 日付 | 更新者 | 更新内容 |
|------|--------|----------|
| 2025-07-27 | Claude | 初版作成 |