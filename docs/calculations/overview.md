# ステータス計算式 概要

## 目的
トーラムオンラインにおけるステータス計算式の詳細な仕様を記録し、ダメージ計算システムの実装参考とする。

## ディレクトリ構成

```
docs/calculations/
├── overview.md              # この概要ファイル
├── basic-stats.md           # 基本ステータス（HP、MP等）
├── attack-stats.md          # 攻撃関連ステータス（ATK、MATK等）
├── defense-stats.md         # 防御関連ステータス（DEF、MDEF等）
├── hit-flee-stats.md        # 命中・回避関連ステータス
├── critical-stats.md        # クリティカル関連ステータス
├── speed-stats.md           # 速度関連ステータス（ASPD、CSPD等）
├── penetration-stats.md     # 貫通関連ステータス
├── resistance-stats.md      # 耐性・軽減関連ステータス
├── equipment-bonuses.md     # 装備品補正値計算
├── crystal-effects.md       # クリスタ効果計算
├── food-buffs.md           # 料理バフ効果計算
├── skill-buffs.md          # スキルバフ効果計算
└── damage-formulas.md      # 最終ダメージ計算式
```

## 計算式の記述形式

### 基本原則
1. **実測値ベース**: 実際のゲーム内での検証結果を元にする
2. **段階的計算**: 複雑な式は段階に分けて説明
3. **具体例**: 数値例を併記して理解しやすくする
4. **更新履歴**: 計算式の変更履歴を記録

### 記述テンプレート
```markdown
## ステータス名

### 基本計算式
```
最終値 = 基本値 + 装備補正 + クリスタ補正 + バフ補正
```

### 詳細計算
1. **基本値計算**
   - 式: `基本値 = 基礎ステータス × 係数 + 固定値`
   - 例: `HP基本値 = VIT × 2.5 + レベル × 5 + 100`

2. **装備補正計算**
   - 装備品からのHP補正値の合計
   - 装備品からのHP%補正の適用

3. **最終計算**
   - 各種補正を適用した最終値
```

## 実装への適用

### TypeScript型定義
計算式は以下の型定義と対応:
- `CalculationResults` (src/types/calculationResult.ts)
- `EquipmentProperties` (src/types/calculator.ts)

### 計算ロジック実装
- 段階的計算での実装を推奨
- 中間値の保持によるデバッグ容易性の確保
- 計算結果の検証機能の実装

## 検証方法

### ゲーム内検証
1. 特定の装備・クリスタ構成でのステータス確認
2. 複数パターンでの数値確認
3. バフ適用前後での変化確認

### 実装検証
1. 計算結果とゲーム内実値の比較
2. 境界値での動作確認
3. パフォーマンステスト

## 更新履歴

| 日付 | 更新内容 | 担当 |
|------|----------|------|
| 2024-06-23 | 計算式ドキュメント作成開始 | Claude |

## 参考資料

### 公式情報
- トーラムオンライン公式サイト
- 公式攻略情報

### コミュニティ検証
- プレイヤーによる検証データ
- 攻略サイトでの計算式情報

### 注意事項
- ゲームアップデートによる計算式変更の可能性
- 端数処理の詳細確認の必要性
- 隠しパラメータの存在可能性